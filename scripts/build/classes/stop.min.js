routely.stop=function(){"use strict";var a=routely.ajax,b=routely.api,c=routely.schedule,d="<li rel='{{id}}' class='js-stop r-stop' title='Click to see schedule from {{name}} to {{towards}}'>{{name}} <span>-</span> {{towards}}</li>",e=Handlebars.compile(d),f=null,g=function(c,d){var e=b.getStops(d),f=c.serviceContainer,g=c.scheduleContainer;f.html("<p><img src='images/ajax-loader.gif' alt='loading' /></p>"),g.html(""),a.get(c,e,null,h)},h=function(a){if(a.Success){var b=a.Data,c=b.markers,d=a.Model,e=d.map,g=d.serviceContainer,h=d.scheduleContainer;if(c.length>0){f="";for(var k=0;k<c.length;k++){{var l=c[k],m=new google.maps.LatLng(l.lat,l.lng);new google.maps.Marker({position:m,map:e})}f+=i(l)}j(g,h,f)}else g.html("<p>No bus stops in this area.</p>")}},i=function(a){return e(a)},j=function(a,b,c){a.html(c);a.find(".js-stop");k(a,b)},k=function(a,b){var d=a.find(".js-stop");d.on("click",function(){c.get(this,b)})};return{getStops:g}}();